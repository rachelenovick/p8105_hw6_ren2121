p8105_hw6_ren2121
================
2025-11-29

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.2     ✔ tibble    3.3.0
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.1.0     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

## Problem 1

Reading in the dataset from github:

``` r
url = "https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv"

homicides = read_csv(url)
```

    ## Rows: 52179 Columns: 12
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (9): uid, victim_last, victim_first, victim_race, victim_age, victim_sex...
    ## dbl (3): reported_date, lat, lon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Creating a city_state variable, and a binary variable indicating whether
the homicide is solved. Omitting cities that do not report victim race,
limiting the analysis by race, and converting age to a numeric variable.

``` r
homicides =
  homicides |> 
  mutate(
    city_state = paste(city, state, sep = ", "),
    solved = case_when(
      disposition %in% c("Closed without arrest", "Open/No arrest") ~ 0,
      disposition == "Closed by arrest" ~ 1
    ),
    victim_age = parse_number(as.character(victim_age))
  ) |> 
  filter(
    !city_state %in% c("Dallas, TX", "Phoenix, AZ", "Kansas City, MO", "Tulsa, AL"),
    victim_race %in% c("White", "Black")
    )
```

    ## Warning: There was 1 warning in `mutate()`.
    ## ℹ In argument: `victim_age = parse_number(as.character(victim_age))`.
    ## Caused by warning:
    ## ! 2999 parsing failures.
    ## row col expected  actual
    ##  12  -- a number Unknown
    ##  60  -- a number Unknown
    ## 103  -- a number Unknown
    ## 122  -- a number Unknown
    ## 165  -- a number Unknown
    ## ... ... ........ .......
    ## See problems(...) for more details.

Fitting a logistic regression, for the city of Baltimore, with resolved
vs. unresolved as the outcome and victim age, sex and race as
predictors. Obtaining the estimate and confidence interval of the
adjusted odds ratio for solving homicides comparing male victims to
female victims, keeping all other variables fixed.

``` r
baltimore = 
  homicides |> 
  filter(city_state == "Baltimore, MD")

crime_fit = glm(
  solved ~ victim_age + victim_sex + victim_race, 
  data = baltimore,
  family = binomial) #specifies logistic regression

crime_fit |> 
  broom::tidy(exponentiate = TRUE, conf.int = TRUE) |> 
  select(term, estimate, conf.low, conf.high) |> 
  filter(term == "victim_sexMale") |> 
  knitr::kable()
```

| term           |  estimate |  conf.low | conf.high |
|:---------------|----------:|----------:|----------:|
| victim_sexMale | 0.4255117 | 0.3241908 | 0.5575508 |

The odds of a homicide being solved for male victims is 0.426 times the
odds of a homicide being solved for female victims, adjusting for age
and race.
